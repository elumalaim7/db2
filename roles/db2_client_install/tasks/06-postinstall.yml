---
- name: move the "{{ user_name }}" instance to "{{ standard_user }}"...
  command: mv "{{ db2_inst_home }}"/sqllib /home/"{{ standard_user }}" 
  register: db2_rename_instance

- name: Print rename instance output...
  debug:
    msg: "{{ db2_rename_instance }}" 

- name: replace line DB2INSTANCE = "{{ user_name }}" in /home/"{{ standard_user }}"/sqllib/db2profile
  lineinfile: 
    path: "/home/{{ standard_user }}/sqllib/db2profile" 
    regexp: '^(.*)DB2INSTANCE="{{ user_name }}"(.*)$' 
    line: 'DB2INSTANCE="{{ standard_user }}"'
    backrefs: yes

- name: replace line "{{ standard_user }}" in /home/{{ standard_user }}/sqllib/db2profile
  lineinfile: 
    path: "/home/{{ standard_user }}/sqllib/db2profile" 
    regexp: '^(.*)INSTHOME=/home/"{{ user_name }}"(.*)$' 
    line: 'INSTHOME=/home/"{{ standard_user }}"'
    backrefs: yes

- name: move the /home/{{ standard_user }}/sqllib instance to "{{ db2_home }}"...
  command: mv /home/{{ standard_user }}/sqllib "{{ db2_home }}/" 
  register: db2_instance_move

- name: Print instance move to "{{ db2_home }}" output...
  debug:
    msg: "{{ db2_instance_move }}" 

- name: Validating DB2 
  command: "/home/{{ standard_user }}/sqllib/bin/db2val -o"
  register: db2_val

- name: Validate results
  debug: var=db2_val

